<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Pakistan National Students Database â€” Admin</title>

  <!-- Tailwind & Font Awesome -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous"/>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>

  <style>
    /* Core theme variables */
    :root {
      --accent: #0ea5a4;
      --muted: #64748b;
      --text-color: #0f172a;
      --card-bg: rgba(255,255,255,0.95);
      --glass-border: rgba(0,0,0,0.1);
    }

    body {
      background: #f1f5f9;
      color: var(--text-color);
      font-family: Inter, system-ui, Arial, sans-serif;
    }

    /* Utility Glass & Cards */
    .glass { background: var(--card-bg); border:1px solid var(--glass-border); backdrop-filter: blur(6px); }
    .rounded-card { border-radius:12px; }
    .card-hover { transition: all .15s ease; }
    .card-hover:hover { transform: translateY(-3px); box-shadow: 0 6px 18px rgba(0,0,0,0.1); }

    /* Status badges */
    .status-badge {
      font-weight:700; padding:6px 10px; border-radius:999px; font-size:.85rem;
      display:inline-flex; align-items:center; justify-content:center; color:white;
    }
    .badge-verified { background:#10b981; }
    .badge-pending { background:#f97316; }
    .badge-rejected { background:#ef4444; }
    .badge-review { background:#3b82f6; }

    /* Inputs */
    input, select, textarea {
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 6px;
      padding: 8px;
    }
    input[readonly], textarea[readonly] {
      background-color: #f8fafc;
      cursor: text;
    }

    /* Modal */
    .modal { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.6);
      display:flex; justify-content:center; align-items:center; z-index:1000; }
    .modal-content { background:white; border-radius:12px; padding:24px; max-width:90%; overflow:auto; }
    @media(min-width:768px){ .modal-content { max-width:700px; } }

    /* Logo */
    .logo-container {
      width: 44px; height:44px; background:linear-gradient(45deg,#0ea5a4,#06b6d4);
      border-radius:8px; color:white; font-weight:700; font-size:1.2rem;
      display:flex; align-items:center; justify-content:center;
    }

  </style>
</head>
<body class="min-h-screen">

  <!-- Header -->
  <header class="glass rounded-card max-w-7xl mx-auto mt-6 p-4 flex items-center justify-between">
    <div class="flex items-center gap-4">
      <div class="logo-container">PN</div>
      <div>
        <div class="text-lg font-semibold">Pakistan National Students Database</div>
        <div class="text-sm text-[--muted]">Student verification & administration</div>
      </div>
    </div>

    <div class="flex items-center gap-3">
      <button id="nav-search" class="px-3 py-2 text-sm rounded hover:bg-gray-100 font-medium">Search</button>
      <button id="btn-login" class="bg-[--accent] text-white px-3 py-2 rounded font-semibold hover:opacity-90">Login</button>

      <div id="user-session-container" class="relative">
        <button id="user-dropdown-toggle" class="hidden flex items-center gap-2 px-3 py-2 text-sm rounded hover:bg-gray-100 font-medium">
          <span id="session-display-text" class="font-semibold text-[--accent]">Admin</span>
          <i class="fas fa-caret-down"></i>
        </button>
        <div id="user-dropdown-menu" class="hidden absolute right-0 mt-2 w-48 rounded-md bg-white shadow-lg ring-1 ring-black ring-opacity-5">
          <div class="py-1">
            <div id="session-email" class="block px-4 py-2 text-sm text-gray-500 truncate font-semibold"></div>
            <button id="dropdown-btn-admin" class="w-full text-left px-4 py-2 text-sm hover:bg-gray-100">Admin Panel</button>
            <button id="dropdown-btn-settings-logout" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100">Logout</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main App Sections -->
  <main class="max-w-7xl mx-auto mt-6 px-4 pb-12 space-y-6">
    <!-- Search -->
    <section id="section-search" class="glass rounded-card p-6">
      <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
        <div>
          <h1 class="text-2xl font-semibold">Search Student Records</h1>
          <p class="text-sm text-[--muted]">Search by full name, roll number, or student ID.</p>
        </div>
        <div class="flex gap-2">
          <input id="search-input" type="text" placeholder="Enter name, roll number, or ID..." class="border rounded px-4 py-2 flex-1"/>
          <button id="search-btn" class="bg-[--accent] text-white px-4 py-2 rounded"><i class="fas fa-search"></i></button>
          <button id="clear-search" class="bg-gray-200 text-gray-700 px-4 py-2 rounded"><i class="fas fa-undo"></i></button>
        </div>
      </div>
      <div id="search-results" class="mt-6"></div>
    </section>

    <!-- Login -->
    <section id="section-login" class="hidden flex justify-center items-center min-h-[40vh]">
      <div class="glass rounded-card p-8 w-full max-w-sm">
        <h2 class="text-2xl font-bold mb-4 text-center text-[--accent]">Admin Login</h2>
        <form id="login-form" class="space-y-4">
          <div>
            <label>Email</label>
            <input id="login-email" name="email" type="email" class="w-full border rounded px-3 py-2" required/>
          </div>
          <div>
            <label>Password</label>
            <input id="login-password" name="password" type="password" class="w-full border rounded px-3 py-2" required/>
          </div>
          <p id="login-error" class="hidden text-red-600 text-sm text-center"></p>
          <div class="flex gap-3">
            <button type="submit" class="flex-1 bg-[--accent] text-white rounded py-2">Login</button>
            <button id="cancel-login" type="button" class="flex-1 border rounded py-2">Cancel</button>
          </div>
        </form>
      </div>
    </section>

    <!-- Admin Panel -->
    <section id="section-admin" class="hidden space-y-6">
      <!-- Form -->
      <div class="glass rounded-card p-6">
        <h2 id="student-form-title" class="text-xl font-semibold">Add New Student</h2>
        <form id="student-form" class="grid grid-cols-1 md:grid-cols-4 gap-3 mt-4">
          <input type="hidden" id="student_id_edit" name="student_id_edit"/>

          <input id="name" name="name" placeholder="Full Name *" class="md:col-span-2 border px-3 py-2" required>
          <input id="roll_number" name="roll_number" placeholder="Roll Number *" class="border px-3 py-2" required>
          <input id="class" name="class" placeholder="Class" class="border px-3 py-2">
          <input id="father_name" name="father_name" placeholder="Father's Name" class="md:col-span-2 border px-3 py-2">
          <input id="father_contact" name="father_contact" placeholder="Father's Contact" class="border px-3 py-2">
          <input id="contact_number" name="contact_number" placeholder="Student Contact" class="border px-3 py-2">
          <input id="email_student" name="email_student" type="email" placeholder="Student Email" class="border px-3 py-2">
          <select id="gender" name="gender" class="border px-3 py-2">
            <option value="">Select Gender</option><option>Male</option><option>Female</option><option>Other</option>
          </select>
          <input id="blood_group" name="blood_group" placeholder="Blood Group" class="border px-3 py-2">
          <input id="dob" name="dob" type="date" class="border px-3 py-2">
          <input id="admission_date" name="admission_date" type="date" class="border px-3 py-2">
          <input id="iq_level" name="iq_level" placeholder="IQ Level" class="border px-3 py-2">
          <input id="photo" name="photo" type="file" accept="image/*" class="border px-3 py-2 md:col-span-1" required>
          <select id="verification_status" name="verification_status" class="border px-3 py-2">
            <option value="verified">Verified</option>
            <option value="pending">Pending</option>
            <option value="rejected">Rejected</option>
            <option value="under_review">Under Review</option>
          </select>
          <textarea id="address" name="address" placeholder="Address" class="md:col-span-4 border px-3 py-2"></textarea>

          <div class="md:col-span-4 flex justify-end gap-3 pt-2">
            <button type="submit" id="btn-submit-student" class="bg-[--accent] text-white px-4 py-2 rounded font-semibold"><i class="fas fa-plus-circle"></i> Add Student</button>
            <button id="btn-cancel-edit" type="button" class="hidden px-4 py-2 border rounded"><i class="fas fa-times"></i> Cancel Edit</button>
            <button id="btn-reset" type="button" class="px-4 py-2 border rounded"><i class="fas fa-sync-alt"></i> Reset</button>
          </div>
        </form>
        <p id="form-message" class="hidden mt-2 text-sm"></p>
      </div>

      <!-- List Table -->
      <div class="glass rounded-card p-6">
        <div class="flex justify-between items-center">
          <h3 class="text-xl font-semibold">Manage All Students</h3>
          <div class="flex gap-2">
            <button id="btn-refresh" class="border rounded px-3 py-1 hover:bg-gray-100"><i class="fas fa-redo"></i> Refresh</button>
            <button id="btn-export" class="bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600"><i class="fas fa-file-csv"></i> Export CSV</button>
          </div>
        </div>
        <div class="overflow-x-auto mt-4">
          <table class="min-w-full text-sm">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-3 py-2 text-left">Photo</th>
                <th class="px-3 py-2 text-left">Name / ID</th>
                <th class="px-3 py-2 text-left">Roll</th>
                <th class="px-3 py-2 text-left">Status</th>
                <th class="px-3 py-2 text-right">Actions</th>
              </tr>
            </thead>
            <tbody id="admin-list-body">
              <tr><td colspan="5" class="text-center py-4 text-gray-500">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal -->
  <div id="student-preview-modal" class="modal hidden">
    <div class="modal-content relative">
      <button id="modal-close-btn" class="absolute top-2 right-3 text-gray-500 hover:text-gray-800 text-xl"><i class="fas fa-times-circle"></i></button>
      <h3 class="text-xl font-bold text-[--accent] border-b pb-2 mb-4">Student Full Details</h3>
      <div id="modal-body"></div>
    </div>
  </div>

  <!-- Scripts -->
  <script type="module" src="./main.js"></script>
</body>
</html>
